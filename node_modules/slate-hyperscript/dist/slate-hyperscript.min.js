!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("slate")):"function"==typeof define&&define.amd?define(["exports","slate"],e):e(t.SlateHyperscript={},t.Slate)}(this,function(t,e){"use strict";var n=function(t){return null!=t&&"object"==typeof t&&!1===Array.isArray(t)};function r(t){return!0===n(t)&&"[object Object]"===Object.prototype.toString.call(t)}var o=function(t){var e,n;return!1!==r(t)&&("function"==typeof(e=t.constructor)&&(!1!==r(n=e.prototype)&&!1!==n.hasOwnProperty("isPrototypeOf")))},i=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},a=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},s=function(t,e){var n={};for(var r in t)e.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n},f=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),c=0;function u(t,e,n){return new S(e)}function l(t,e,n){return _(null,a({},e,{object:"block"}),n)}function d(t,e,n){return new x(e)}function h(t,e,n){var r=e.key,o=e.data,i=t;if(r)return new O({id:r,type:i,data:o});var a=w(n),s=a.first(),f=a.last(),u=""+c++,l=new O({id:u,type:i,data:o}),d=new O({id:u,type:i,data:o});return P(s,l,0),P(f,d,f.text.length),a}function y(t,e,n){return _(null,a({},e,{object:"document"}),n)}function v(t,e,n){return new j(e)}function p(t,e,n){return _(null,a({},e,{object:"inline"}),n)}function k(t,n,r){var o=n.key,i=s(n,["key"]),a=e.Mark.createSet([i]),f=w(r);if(f.size>1)throw new Error("The <mark> hyperscript tag must only contain a single node's worth of children.");return 0===f.size?e.Text.create({key:o,marks:a}):E(f.first(),function(t){return o&&(t=t.set("key",o)),a&&(t=t.set("marks",t.marks.union(a))),t})}function _(t,n,r){if("text"===n.object)return b(null,n,r);var o=w(r);return e.Node.create(a({},n,{nodes:o}))}function m(t,n,r){var o=r.find(function(t){return t instanceof S}),i=r.find(function(t){return t instanceof j}),a=n.marks,s=n.focused;return e.Selection.create({marks:a,isFocused:s,anchor:o&&{key:o.key,offset:o.offset,path:o.path},focus:i&&{key:i.key,offset:i.offset,path:i.path}})}function b(t,n,r){var o=n.key,i=n.marks,a=w(r);if(a.size>1)throw new Error("The <text> hyperscript tag must only contain a single node's worth of children.");return 0===a.size?e.Text.create({key:o}):E(a.first(),function(t){return o&&(t=t.set("key",o)),i&&(t=t.set("marks",e.Mark.createSet(i))),t})}function g(t,n,r){var o=n.data,i=r.find(e.Document.isDocument),s=r.find(e.Selection.isSelection),c=void 0,u=void 0,l=void 0,d=void 0,h={},y={};if(i){var v=!0,p=!1,k=void 0;try{for(var _,m=i.texts()[Symbol.iterator]();!(v=(_=m.next()).done);v=!0){var b=_.value,g=f(b,2),w=g[0],x=g[1],S=w.__anchor,j=w.__annotations,O=w.__focus;if(null!=S&&(c=e.Point.create({path:x,key:w.key,offset:S.offset}),l=S.marks,d=S.isFocused),null!=O&&(u=e.Point.create({path:x,key:w.key,offset:O.offset}),l=O.marks,d=O.isFocused),null!=j){var E=!0,F=!1,P=void 0;try{for(var N,T=j[Symbol.iterator]();!(E=(N=T.next()).done);E=!0){var z=N.value,A=z.id,M=y[A];if(delete y[A],M){var D=e.Annotation.create({key:A,type:z.type,data:z.data,anchor:{key:M.key,path:i.getPath(M.key),offset:M.offset},focus:{path:x,key:w.key,offset:z.offset}});h[A]=D}else z.key=w.key,y[A]=z}}catch(t){F=!0,P=t}finally{try{!E&&T.return&&T.return()}finally{if(F)throw P}}}}}catch(t){p=!0,k=t}finally{try{!v&&m.return&&m.return()}finally{if(p)throw k}}}if(Object.keys(y).length>0)throw new Error("Slate hyperscript must have both a start and an end defined for each annotation using the `key=` prop.");if(c&&!u)throw new Error("Slate hyperscript ranges must have both `<anchor />` and `<focus />` defined if one is defined, but you only defined `<anchor />`. For collapsed selections, use `<cursor />` instead.");if(!c&&u)throw new Error("Slate hyperscript ranges must have both `<anchor />` and `<focus />` defined if one is defined, but you only defined `<focus />`. For collapsed selections, use `<cursor />` instead.");return c||u?s=s?s.setPoints([c,u]):e.Selection.create({anchor:c,focus:u,isFocused:d,marks:l}):s||(s=e.Selection.create()),s=s.normalize(i),h.length>0&&(h=h.map(function(t){return t.normalize(i)})),e.Value.fromJSON(a({data:o,annotations:h,document:i,selection:s},n))}function w(t){var n=e.Node.createList(),r=function(t){var r=n.last(),o="string"==typeof t;if(r&&r.__string&&(o||t.__string)){var i=o?t:t.text,a=r.text.length,s=E(r,function(t){return t.insertText(a,i)});!function(t,e){var n=t.__anchor,r=t.__focus,o=t.__annotations;null!=n&&(n.offset+=e);null!=r&&r!==n&&(r.offset+=e);null!=o&&o.forEach(function(t){return t.offset+=e})}(t,a),F(t,s),s.__string=!0,n=n.pop().push(s)}else o?((t=e.Text.create({text:t})).__string=!0,n=n.push(t)):n=n.push(t)};return t.forEach(function(t){if(e.Node.isNodeList(t)&&t.forEach(function(t){return r(t)}),e.Node.isNode(t)&&r(t),"string"==typeof t&&r(t),(i=t)instanceof S||i instanceof x||i instanceof O||i instanceof j){n.size||r("");var o=n.last();"text"!==o.object&&(r(""),o=n.last()),o&&o.__string||(r(""),o=n.last()),P(o,t,o.text.length)}var i}),n}var x=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t);var n=e.isFocused,r=void 0===n||n,o=e.marks,a=void 0===o?null:o;this.isFocused=r,this.marks=a,this.offset=null},S=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t);var n=e.isFocused,r=void 0===n||n,o=e.key,a=void 0===o?null:o,s=e.marks,f=void 0===s?null:s,c=e.offset,u=void 0===c?null:c,l=e.path,d=void 0===l?null:l;this.isFocused=r,this.key=a,this.marks=f,this.offset=u,this.path=d},j=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t);var n=e.isFocused,r=void 0===n||n,o=e.key,a=void 0===o?null:o,s=e.marks,f=void 0===s?null:s,c=e.offset,u=void 0===c?null:c,l=e.path,d=void 0===l?null:l;this.isFocused=r,this.key=a,this.marks=f,this.offset=u,this.path=d},O=function t(e){i(this,t);var n=e.id,r=void 0===n?null:n,o=e.data,a=void 0===o?{}:o,s=e.type;this.id=r,this.offset=null,this.type=s,this.data=a};function E(t,e){var n=e(t);return F(t,n),n}function F(t,e){var n=t.__anchor,r=t.__focus,o=t.__annotations;null!=n&&(e.__anchor=n),null!=r&&(e.__focus=r),null!=o&&(e.__annotations=o)}function P(t,e,n){(e instanceof S||e instanceof x)&&(e.offset=n,t.__anchor=e),(e instanceof j||e instanceof x)&&(e.offset=n,t.__focus=e),e instanceof O&&(e.offset=n,t.__annotations=t.__annotations||[],t.__annotations=t.__annotations.concat(e))}function N(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.blocks,n=void 0===e?{}:e,r=t.inlines,i=void 0===r?{}:r,s=t.marks,f=void 0===s?{}:s,c=t.annotations,w=void 0===c?{}:c,x=a({anchor:u,annotation:h,block:l,cursor:d,document:y,focus:v,inline:p,mark:k,node:_,selection:m,text:b,value:g},t.creators||{});for(var S in n)x[S]=T(n[S],l);for(var j in i)x[j]=T(i[j],p);for(var O in f)x[O]=T(f[O],k);for(var E in w)x[E]=T(w[E],h);return function(t,e){for(var n=arguments.length,r=Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];var a=x[t];if(!a)throw new Error('No hyperscript creator found for tag: "'+t+'"');return null==e&&(e={}),o(e)||(r=[e].concat(r),e={}),a(t,e,r=r.filter(function(t){return Boolean(t)}).reduce(function(t,e){return t.concat(e)},[]))}}function T(t,e){if("function"==typeof t)return t;if("string"==typeof t&&(t={type:t}),o(t))return function(n,r,o){var i=r.key,f=s(r,["key"]),c=a({},t,{key:i,data:a({},t.data||{},f)});return e(n,c,o)};throw new Error("Slate hyperscript creators can be either functions, objects or strings, but you passed: "+t)}var z=N();t.default=z,t.createHyperscript=N,Object.defineProperty(t,"__esModule",{value:!0})});
